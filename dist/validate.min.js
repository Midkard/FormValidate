/**
* FormValidate v1.2.1
*/
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(A){var n,e=navigator.userAgent,$=/iphone/i.test(e),a=/chrome/i.test(e),R=/android/i.test(e);A.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},A.fn.extend({caret:function(e,t){var i;if(0!==this.length&&!this.is(":hidden")&&this.get(0)===document.activeElement)return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((i=this.createTextRange()).collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(t,g){var i,b,k,y,_,x,E;if(!t&&0<this.length){var e=A(this[0]).data(A.mask.dataName);return e?e():void 0}return g=A.extend({autoclear:A.mask.autoclear,placeholder:A.mask.placeholder,completed:null},g),i=A.mask.definitions,b=[],k=x=t.length,y=null,t=String(t),A.each(t.split(""),function(e,t){"?"==t?(x--,k=e):i[t]?(b.push(new RegExp(i[t])),null===y&&(y=b.length-1),e<k&&(_=b.length-1)):b.push(null)}),this.trigger("unmask").each(function(){var r=A(this),s=A.map(t.split(""),function(e,t){if("?"!=e)return i[e]?u(t):e}),o=s.join(""),l=r.val();function h(){if(g.completed){for(var e=y;e<=_;e++)if(b[e]&&s[e]===u(e))return;g.completed.call(r)}}function u(e){return e<g.placeholder.length?g.placeholder.charAt(e):g.placeholder.charAt(0)}function c(e){for(;++e<x&&!b[e];);return e}function f(e,t){var i,n;if(!(e<0)){for(i=e,n=c(t);i<x;i++)if(b[i]){if(!(n<x&&b[i].test(s[n])))break;s[i]=s[n],s[n]=u(n),n=c(n)}m(),r.caret(Math.max(y,e))}}function d(e){v(),r.val()!=l&&r.change()}function p(e,t){var i;for(i=e;i<t&&i<x;i++)b[i]&&(s[i]=u(i))}function m(){r.val(s.join(""))}function v(e){var t,i,n,a=r.val(),l=-1;for(n=t=0;t<x;t++)if(b[t]){for(s[t]=u(t);n++<a.length;)if(i=a.charAt(n-1),b[t].test(i)){s[t]=i,l=t;break}if(n>a.length){p(t+1,x);break}}else s[t]===a.charAt(n)&&n++,t<k&&(l=t);return e?m():l+1<k?g.autoclear||s.join("")===o?(r.val()&&r.val(""),p(0,x)):m():(m(),r.val(r.val().substring(0,l+1))),k?t:y}r.data(A.mask.dataName,function(){return A.map(s,function(e,t){return b[t]&&e!=u(t)?e:null}).join("")}),r.one("unmask",function(){r.off(".mask").removeData(A.mask.dataName)}).on("focus.mask",function(){var e;r.prop("readonly")||(clearTimeout(n),l=r.val(),e=v(),n=setTimeout(function(){r.get(0)===document.activeElement&&(m(),e==t.replace("?","").length?r.caret(0,e):r.caret(e))},10))}).on("blur.mask",d).on("keydown.mask",function(e){if(!r.prop("readonly")){var t,i,n,a=e.which||e.keyCode;E=r.val(),8===a||46===a||$&&127===a?(i=(t=r.caret()).begin,(n=t.end)-i==0&&(i=46!==a?function(e){for(;0<=--e&&!b[e];);return e}(i):n=c(i-1),n=46===a?c(n):n),p(i,n),f(i,n-1),e.preventDefault()):13===a?d.call(this,e):27===a&&(r.val(l),r.caret(0,v()),e.preventDefault())}}).on("keypress.mask",function(e){if(!r.prop("readonly")){var t,i,n,a=e.which||e.keyCode,l=r.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||a<32)&&a&&13!==a){if(l.end-l.begin!=0&&(p(l.begin,l.end),f(l.begin,l.end-1)),(t=c(l.begin-1))<x&&(i=String.fromCharCode(a),b[t].test(i))){if(function(e){var t,i,n,a;for(i=u(t=e);t<x;t++)if(b[t]){if(n=c(t),a=s[t],s[t]=i,!(n<x&&b[n].test(a)))break;i=a}}(t),s[t]=i,m(),n=c(t),R){setTimeout(function(){A.proxy(A.fn.caret,r,n)()},0)}else r.caret(n);l.begin<=_&&h()}e.preventDefault()}}}).on("input.mask paste.mask",function(){r.prop("readonly")||setTimeout(function(){var e=v(!0);r.caret(e),h()},0)}),a&&R&&r.off("input.mask").on("input.mask",function(e){var t=r.val(),i=r.caret();if(E&&E.length&&E.length>t.length){for(v(!0);0<i.begin&&!b[i.begin-1];)i.begin--;if(0===i.begin)for(;i.begin<y&&!b[i.begin];)i.begin++;r.caret(i.begin,i.begin)}else{v(!0);var n=t.charAt(i.begin);i.begin<x&&(b[i.begin]||i.begin++,b[i.begin].test(n)&&i.begin++),r.caret(i.begin,i.begin)}h()}),v()})}})}),$(function(){if($.fancybox){var i=$.fancybox.defaults.clickContent;$.fancybox.defaults.clickContent=function(e,t){e.$content[0].contains(document.activeElement)&&document.activeElement.blur(),i(e,t)}}}),function(l){"use strict";var i;l.fn.validate=function(e){if(this.length)return i=void 0===(e=e||{}).hideLabels||e.hideLabels,this.each(function(){var e=l(this).data("validator");e||(l(this).find(".inp").mask("+7 (999) 999-99-99",{completed:function(){l(this).trigger("completed")}}),l(this).find("span.add-textarea").click(function(){l(this).toggleClass("opened")}),o=o||new u,e=new s(this),l(this).data("validator",e))}),this};var c=/^(.+?)\[(.+)\]$/,t=/^[0-9]+$/,e=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/,n=/^[а-яё ]*$/i,a=/^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/,f={required:"Пожалуйста, заполните поле.",valid_email:"Введите корректный email.",valid_phone:"Введите корректный номер телефона.",alpha:"Это поле может содержать только буквы русского алфавита.",min_length:"Поле должно содержать не менее %s символов."},r=[{el:".required",rule:"required"},{el:".inp",rule:"valid_phone"},{el:'[name="name1"]',rule:"alpha|min_length[2]"},{el:'[name="email1"]',rule:"valid_email"},{el:".agreement",rule:"agreement"}],s=function(e){this.form=e,this.allRules=r,this.buttons=[],this.fields=[];for(var t=0;t<e.elements.length;t++)if("submit"!==e.elements[t].type){var i=l(e.elements[t]),n=this._genElemRules(i);n.length?this.fields.push(new h(i,n.join("|"),this)):this.fields.push(new h(i,null,this))}else this.buttons.push(e.elements[t]);this._checkButtons(),l(e).submit(l.proxy(this,"_validateForm"))};l.extend(s.prototype,{_genElemRules:function(e){for(var t={},i=[],n=0;n<this.allRules.length;n++)e.is(this.allRules[n].el)&&(t[this.allRules[n].rule]=!0);for(var a in t)i.push(a);return i},_validateForm:function(e){for(var t=!1,i=0;i<this.fields.length;i++){this.fields[i]._validate()||(t=!0)}return t&&(e&&e.preventDefault?e.preventDefault():event&&(event.returnValue=!1)),!0},_checkButtons:function(){for(var e=!1,t=0;t<this.fields.length;t++){this.fields[t].valid||(e=!0)}var i=!1;e&&(i=!0);for(t=0;t<this.buttons.length;t++)this.buttons[t].disabled=i}});var o,h=function(e,t,i){this.elem=e,this.rules=t,this.value=null,this.oldValue="",this.rules&&(this.erElem=null,this.tipElem=null,this.required=-1!==t.indexOf("required"),this.filterInput=-1!==t.indexOf("alpha")),this.$placeholder=null,l(this.elem).siblings("label").length&&(this.$placeholder=l(this.elem).siblings("label"));var n=!0;Object.defineProperty(this,"valid",{get:function(){return n},set:function(e){e!==n&&(n=e,i._checkButtons())}}),this._validate(!0);var a=this;this.rules&&(e.on("blur change completed",function(){a._validate()}),e.on("input keypress keydown paste",function(){a._validate(!0)})),this.filterInput&&(e.on("input",function(){a._testInput()}),e.on("focusout",function(){a._tip(!0)})),this.$placeholder&&(e.on("focusin",function(){a._placeholder()}),e.on("focusout",function(){a._placeholder(!0)}))};l.extend(h.prototype,{_validate:function(e){if(e=e||!1,!this.rules)return!0;if(this.value!==this.elem.val()||!e){var t,i,n=this.rules.split("|"),a=!this.elem.val(),l=[];for(this.value=this.elem.val(),t=0,i=n.length;t<i;t++){var r=n[t],s=null,o=!1,h=c.exec(r);if(a&&!this.required)break;if((!a||-1!==["required","agreement"].indexOf(r))&&(h&&(r=h[1],s=h[2]),"!"===r.charAt(0)&&(r=r.substring(1,r.length)),"function"==typeof this._hooks[r]&&(this._hooks[r].apply(this,[s])||(o=!0)),o)){var u=f[r];s&&(u=u.replace("%s",s)),l.push(u)}}return l.length?(e||this._setError(l),this.valid=!1):(this._removeError(),this.valid=!0),this.valid}},_testInput:function(){this.value=this.elem.val(),this._hooks.alpha.apply(this)?(this.oldValue=this.value,this._tip(!0)):(this.elem.val(this.oldValue),this._tip())},_tip:function(e){var t=f.alpha;(e=e||!1)?this.tipElem&&(this.tipElem.remove(),this.tipElem=null):this.tipElem||(this.tipElem=l('<span class="message-tooltip">'+t+"</span>").insertAfter(this.elem))},_placeholder:function(e){var t=!this.elem.val();e=e||!1,i&&(e?t||this.$placeholder.addClass("label-none"):this.$placeholder.removeClass("label-none"))},_setError:function(e){this.erElem?this.erElem.html(e.join(" ")):-1===this.rules.indexOf("agreement")&&(this.erElem=l('<span class="message-error">'+e.join(" ")+"</span>").insertAfter(this.elem)),this.elem.addClass("error"),this.elem.removeClass("correctly")},_removeError:function(){this.erElem&&(this.erElem.remove(),this.erElem=null,this.elem.addClass("correctly"),this.elem.removeClass("error"))},_hooks:{required:function(){var e=this.elem[0].type;return"checkbox"===e||"radio"===e?!0===this.elem[0].checked:!!this.value},valid_email:function(){return e.test(this.value)},valid_phone:function(){return a.test(this.value)},min_length:function(e){return!!t.test(e)&&this.value.length>=parseInt(e,10)},alpha:function(){return n.test(this.value)},agreement:function(){var e=this.elem[0].type;if("checkbox"!==e&&"radio"!==e)return!!this.value;var t=!0===this.elem[0].checked;return t||o.show(this.elem),t}}});var u=function(){this.popup=l('<div id="modal-not-agreement">                    <div class="icon">                            <svg viewBox="0 0 22 22"><path d="M.35.35,21.82,21.82"/><path d="M21.82.35.35,21.82"/></svg>                    </div>                    <h2>Внимание!</h2>                    <p>Вы не согласились с нашей <a href="//privacy-policy/" >политикой конфиденциальности</a>. По Закону, мы не имеем права получать ваши контакты.</p>                    <div class="button">                            <button class="confirm btn">Согласиться с политикой</button>                    </div>            </div>').appendTo("body"),this.overlay=l('<div id="modal-not-agreement__overlay"></div>').appendTo("body"),this.checkbox=null;var e=this;this.popup.find(".confirm").click(function(){e.checkbox.prop("checked",!0),e.checkbox.change(),e.hide()}),this.overlay.click(function(){e.hide()}),this.popup.find(".icon").click(function(){e.hide()})};l.extend(u.prototype,{show:function(e){this.checkbox=e,this.overlay.fadeIn(),this.popup.fadeIn()},hide:function(){this.overlay.fadeOut(),this.popup.fadeOut()}})}(jQuery);